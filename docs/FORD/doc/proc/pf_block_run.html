<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="The library for running PFASST">
    
    <meta name="author" content="Matthew Emmett. Michael Minion, Sebastian Goetschel, Brandon Krull, Francois Hamon" >
    <link rel="icon" href="../favicon.png">

    <title>pf_block_run &ndash; libpfasst</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">libpfasst </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>pf_block_run
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.4% of total for procedures.">63 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/pf_parallel.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/pf_parallel.f90.html'>pf_parallel.f90</a></li>
    
     <li><a href='../module/pf_mod_parallel.html'>pf_mod_parallel</a></li>
    
  
     <li class="active">pf_block_run</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/pf_block_run.html#src">pf_block_run</a>
  </div>
</div>



</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
public subroutine pf_block_run(pf, q0, dt, nsteps, qend, flags)
    
    
   
</h2>
    
  


    
    <p>PFASST controller for block mode
  When starting a new block, broadcast new initial conditions to all procs
  For initial block, this is done when initial conditions are set
 Reset some flags
  Pack away your last solution
  Everyone resets their q0
  Just stick qend in q0
  Update the step and t0 variables for new block
 Call the predictor to get an initial guess on all levels and all processors</p>
<p>Start the loops over SDC sweeps</p>
    

    <h3>Arguments</h3>
    
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-pf%7E25"></span>type(<a href='../type/pf_pfasst_t.html'>pf_pfasst_t</a>),</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>target</td><td>::</td>
  <td><strong>pf</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-q0%7E4"></span>class(<a href='../type/pf_encap_t.html'>pf_encap_t</a>),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>q0</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-dt%7E24"></span>real(kind=pfdp),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>dt</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-nsteps%7E5"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>nsteps</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-qend%7E3"></span>class(<a href='../type/pf_encap_t.html'>pf_encap_t</a>),</td>
  <td>intent(inout),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>qend</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-flags%7E23"></span>integer,</td>
  <td>intent(in),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>flags</strong>(:)</td><td></td>
  
</tr>

</tbody>
</table>

    
    
    
    <br>
    
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: proc~~pf_block_run~~CallsGraph Pages: 1 -->
<svg id="procpf_block_runCallsGraph" width="641pt" height="694pt"
 viewBox="0.00 0.00 641.00 694.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~pf_block_run~~CallsGraph" class="graph" transform="scale(0.986154 0.986154) rotate(0) translate(4 699.748)">
<title>proc~~pf_block_run~~CallsGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-699.748 646,-699.748 646,4 -4,4"/>
<!-- proc~pf_block_run -->
<g id="proc~~pf_block_run~~CallsGraph_node1" class="node"><title>proc~pf_block_run</title>
<polygon fill="none" stroke="black" points="74,-362.305 0,-362.305 0,-338.305 74,-338.305 74,-362.305"/>
<text text-anchor="middle" x="37" y="-347.905" font-family="Helvetica,sans-Serif" font-size="10.50">pf_block_run</text>
</g>
<!-- proc~pf_check_convergence_block -->
<g id="proc~~pf_block_run~~CallsGraph_node2" class="node"><title>proc~pf_check_convergence_block</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node2"><a xlink:href=".././proc/pf_check_convergence_block.html" xlink:title="pf_check_convergence_block">
<polygon fill="#d9534f" stroke="#d9534f" points="264,-107.305 110,-107.305 110,-83.3052 264,-83.3052 264,-107.305"/>
<text text-anchor="middle" x="187" y="-92.9052" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pf_check_convergence_block</text>
</a>
</g>
</g>
<!-- proc~pf_block_run&#45;&gt;proc~pf_check_convergence_block -->
<g id="proc~~pf_block_run~~CallsGraph_edge1" class="edge"><title>proc~pf_block_run&#45;&gt;proc~pf_check_convergence_block</title>
<path fill="none" stroke="#000000" d="M39.2472,-337.986C43.3377,-303.212 59.1461,-202.775 110,-140.305 119.504,-128.631 132.895,-119.293 145.794,-112.216"/>
<polygon fill="#000000" stroke="#000000" points="147.746,-115.148 155.038,-107.461 144.544,-108.923 147.746,-115.148"/>
</g>
<!-- proc~pf_v_cycle -->
<g id="proc~~pf_block_run~~CallsGraph_node3" class="node"><title>proc~pf_v_cycle</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node3"><a xlink:href=".././proc/pf_v_cycle.html" xlink:title="pf_v_cycle">
<polygon fill="#d9534f" stroke="#d9534f" points="218.5,-462.305 155.5,-462.305 155.5,-438.305 218.5,-438.305 218.5,-462.305"/>
<text text-anchor="middle" x="187" y="-447.905" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pf_v_cycle</text>
</a>
</g>
</g>
<!-- proc~pf_block_run&#45;&gt;proc~pf_v_cycle -->
<g id="proc~~pf_block_run~~CallsGraph_edge2" class="edge"><title>proc~pf_block_run&#45;&gt;proc~pf_v_cycle</title>
<path fill="none" stroke="#000000" d="M55.8523,-362.368C81.7428,-379.861 129.878,-412.385 159.796,-432.6"/>
<polygon fill="#000000" stroke="#000000" points="157.839,-435.502 168.084,-438.2 161.758,-429.701 157.839,-435.502"/>
</g>
<!-- proc~pf_predictor -->
<g id="proc~~pf_block_run~~CallsGraph_node4" class="node"><title>proc~pf_predictor</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node4"><a xlink:href=".././proc/pf_predictor.html" xlink:title="pf_predictor">
<polygon fill="#d9534f" stroke="#d9534f" points="222,-362.305 152,-362.305 152,-338.305 222,-338.305 222,-362.305"/>
<text text-anchor="middle" x="187" y="-347.905" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pf_predictor</text>
</a>
</g>
</g>
<!-- proc~pf_block_run&#45;&gt;proc~pf_predictor -->
<g id="proc~~pf_block_run~~CallsGraph_edge3" class="edge"><title>proc~pf_block_run&#45;&gt;proc~pf_predictor</title>
<path fill="none" stroke="#000000" d="M74.2049,-350.305C94.5761,-350.305 120.171,-350.305 141.728,-350.305"/>
<polygon fill="#000000" stroke="#000000" points="141.946,-353.805 151.946,-350.305 141.946,-346.805 141.946,-353.805"/>
</g>
<!-- proc~end_timer -->
<g id="proc~~pf_block_run~~CallsGraph_node5" class="node"><title>proc~end_timer</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node5"><a xlink:href=".././proc/end_timer.html" xlink:title="end_timer">
<polygon fill="#d9534f" stroke="#d9534f" points="634,-435.305 573,-435.305 573,-411.305 634,-411.305 634,-435.305"/>
<text text-anchor="middle" x="603.5" y="-420.905" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">end_timer</text>
</a>
</g>
</g>
<!-- proc~pf_block_run&#45;&gt;proc~end_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge4" class="edge"><title>proc~pf_block_run&#45;&gt;proc~end_timer</title>
<path fill="none" stroke="#000000" d="M39.609,-362.775C44.4836,-396.13 61.8273,-488.77 110,-546.305 218.084,-675.396 294.296,-671.413 462,-686.305 491.661,-688.939 506.001,-705.22 529,-686.305 593.021,-633.651 539.217,-582.086 565,-503.305 571.796,-482.54 582.638,-460.116 590.921,-444.308"/>
<polygon fill="#000000" stroke="#000000" points="594.058,-445.862 595.688,-435.394 587.886,-442.561 594.058,-445.862"/>
</g>
<!-- proc~pf_broadcast -->
<g id="proc~~pf_block_run~~CallsGraph_node6" class="node"><title>proc~pf_broadcast</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node6"><a xlink:href=".././proc/pf_broadcast.html" xlink:title="pf_broadcast">
<polygon fill="#d9534f" stroke="#d9534f" points="400.5,-648.305 325.5,-648.305 325.5,-624.305 400.5,-624.305 400.5,-648.305"/>
<text text-anchor="middle" x="363" y="-633.905" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pf_broadcast</text>
</a>
</g>
</g>
<!-- proc~pf_block_run&#45;&gt;proc~pf_broadcast -->
<g id="proc~~pf_block_run~~CallsGraph_edge5" class="edge"><title>proc~pf_block_run&#45;&gt;proc~pf_broadcast</title>
<path fill="none" stroke="#000000" d="M43.3847,-362.651C53.8592,-385.748 78.7183,-436.316 110,-471.305 180.621,-550.296 206.389,-565.668 300,-615.305 304.957,-617.934 310.309,-620.33 315.718,-622.485"/>
<polygon fill="#000000" stroke="#000000" points="314.851,-625.897 325.444,-626.102 317.291,-619.336 314.851,-625.897"/>
</g>
<!-- proc~call_hooks -->
<g id="proc~~pf_block_run~~CallsGraph_node7" class="node"><title>proc~call_hooks</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node7"><a xlink:href=".././proc/call_hooks.html" xlink:title="call_hooks">
<polygon fill="#d9534f" stroke="#d9534f" points="527,-205.305 464,-205.305 464,-181.305 527,-181.305 527,-205.305"/>
<text text-anchor="middle" x="495.5" y="-190.905" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">call_hooks</text>
</a>
</g>
</g>
<!-- proc~pf_block_run&#45;&gt;proc~call_hooks -->
<g id="proc~~pf_block_run~~CallsGraph_edge6" class="edge"><title>proc~pf_block_run&#45;&gt;proc~call_hooks</title>
<path fill="none" stroke="#000000" d="M54.0364,-338.149C93.3826,-309.104 198.875,-235.893 300,-206.305 351.433,-191.256 413.655,-189.851 453.641,-190.968"/>
<polygon fill="#000000" stroke="#000000" points="453.689,-194.471 463.804,-191.32 453.931,-187.476 453.689,-194.471"/>
</g>
<!-- proc~start_timer -->
<g id="proc~~pf_block_run~~CallsGraph_node8" class="node"><title>proc~start_timer</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node8"><a xlink:href=".././proc/start_timer.html" xlink:title="start_timer">
<polygon fill="#d9534f" stroke="#d9534f" points="635.5,-245.305 571.5,-245.305 571.5,-221.305 635.5,-221.305 635.5,-245.305"/>
<text text-anchor="middle" x="603.5" y="-230.905" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">start_timer</text>
</a>
</g>
</g>
<!-- proc~pf_block_run&#45;&gt;proc~start_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge7" class="edge"><title>proc~pf_block_run&#45;&gt;proc~start_timer</title>
<path fill="none" stroke="#000000" d="M39.6052,-338.143C46.1783,-290.066 72.4803,-113.966 110,-74.3052 170.95,-9.87687 212.378,-27.0259 300,-13.3052 355.326,-4.6417 375.51,10.9185 426,-13.3052 514.02,-55.5348 571.992,-165.422 593.332,-211.972"/>
<polygon fill="#000000" stroke="#000000" points="590.157,-213.445 597.436,-221.144 596.547,-210.586 590.157,-213.445"/>
</g>
<!-- proc~pf_check_convergence_block&#45;&gt;proc~call_hooks -->
<g id="proc~~pf_block_run~~CallsGraph_edge8" class="edge"><title>proc~pf_check_convergence_block&#45;&gt;proc~call_hooks</title>
<path fill="none" stroke="#000000" d="M264.165,-100.537C312.279,-106.028 374.802,-117.276 426,-140.305 444.397,-148.58 462.324,-162.737 475.221,-174.339"/>
<polygon fill="#000000" stroke="#000000" points="472.852,-176.916 482.561,-181.157 477.617,-171.787 472.852,-176.916"/>
</g>
<!-- proc~pf_check_residual -->
<g id="proc~~pf_block_run~~CallsGraph_node16" class="node"><title>proc~pf_check_residual</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node16"><a xlink:href=".././proc/pf_check_residual.html" xlink:title="pf_check_residual">
<polygon fill="#d9534f" stroke="#d9534f" points="412.5,-88.3052 313.5,-88.3052 313.5,-64.3052 412.5,-64.3052 412.5,-88.3052"/>
<text text-anchor="middle" x="363" y="-73.9052" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pf_check_residual</text>
</a>
</g>
</g>
<!-- proc~pf_check_convergence_block&#45;&gt;proc~pf_check_residual -->
<g id="proc~~pf_block_run~~CallsGraph_edge9" class="edge"><title>proc~pf_check_convergence_block&#45;&gt;proc~pf_check_residual</title>
<path fill="none" stroke="#000000" d="M264.066,-86.9991C277.14,-85.5715 290.549,-84.1073 303.086,-82.7383"/>
<polygon fill="#000000" stroke="#000000" points="303.824,-86.1786 313.385,-81.6137 303.065,-79.2199 303.824,-86.1786"/>
</g>
<!-- proc~pf_send_status -->
<g id="proc~~pf_block_run~~CallsGraph_node19" class="node"><title>proc~pf_send_status</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node19"><a xlink:href=".././proc/pf_send_status.html" xlink:title="pf_send_status">
<polygon fill="#d9534f" stroke="#d9534f" points="405.5,-46.3052 320.5,-46.3052 320.5,-22.3052 405.5,-22.3052 405.5,-46.3052"/>
<text text-anchor="middle" x="363" y="-31.9052" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pf_send_status</text>
</a>
</g>
</g>
<!-- proc~pf_check_convergence_block&#45;&gt;proc~pf_send_status -->
<g id="proc~~pf_block_run~~CallsGraph_edge10" class="edge"><title>proc~pf_check_convergence_block&#45;&gt;proc~pf_send_status</title>
<path fill="none" stroke="#000000" d="M221.275,-83.2598C243.527,-75.2443 273.479,-64.5319 300,-55.3052 305.3,-53.4614 310.861,-51.5477 316.387,-49.6596"/>
<polygon fill="#000000" stroke="#000000" points="317.891,-52.845 326.229,-46.3092 315.635,-46.2184 317.891,-52.845"/>
</g>
<!-- proc~restrict_time_space_fas -->
<g id="proc~~pf_block_run~~CallsGraph_node9" class="node"><title>proc~restrict_time_space_fas</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node9"><a xlink:href=".././proc/restrict_time_space_fas.html" xlink:title="restrict_time_space_fas">
<polygon fill="#d9534f" stroke="#d9534f" points="426,-362.305 300,-362.305 300,-338.305 426,-338.305 426,-362.305"/>
<text text-anchor="middle" x="363" y="-347.905" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">restrict_time_space_fas</text>
</a>
</g>
</g>
<!-- proc~pf_v_cycle&#45;&gt;proc~restrict_time_space_fas -->
<g id="proc~~pf_block_run~~CallsGraph_edge11" class="edge"><title>proc~pf_v_cycle&#45;&gt;proc~restrict_time_space_fas</title>
<path fill="none" stroke="#000000" d="M208.988,-438.243C239.689,-420.599 296.993,-387.666 332.094,-367.493"/>
<polygon fill="#000000" stroke="#000000" points="334.011,-370.428 340.937,-362.41 330.523,-364.359 334.011,-370.428"/>
</g>
<!-- proc~pf_post -->
<g id="proc~~pf_block_run~~CallsGraph_node10" class="node"><title>proc~pf_post</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node10"><a xlink:href=".././proc/pf_post.html" xlink:title="pf_post">
<polygon fill="#d9534f" stroke="#d9534f" points="390,-606.305 336,-606.305 336,-582.305 390,-582.305 390,-606.305"/>
<text text-anchor="middle" x="363" y="-591.905" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pf_post</text>
</a>
</g>
</g>
<!-- proc~pf_v_cycle&#45;&gt;proc~pf_post -->
<g id="proc~~pf_block_run~~CallsGraph_edge12" class="edge"><title>proc~pf_v_cycle&#45;&gt;proc~pf_post</title>
<path fill="none" stroke="#000000" d="M198.46,-462.47C223.872,-491.923 287.675,-565.241 300,-573.305 307.962,-578.514 317.347,-582.562 326.372,-585.651"/>
<polygon fill="#000000" stroke="#000000" points="325.353,-589 335.941,-588.637 327.437,-582.317 325.353,-589"/>
</g>
<!-- proc~pf_residual -->
<g id="proc~~pf_block_run~~CallsGraph_node11" class="node"><title>proc~pf_residual</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node11"><a xlink:href=".././proc/pf_residual.html" xlink:title="pf_residual">
<polygon fill="#d9534f" stroke="#d9534f" points="528,-517.305 463,-517.305 463,-493.305 528,-493.305 528,-517.305"/>
<text text-anchor="middle" x="495.5" y="-502.905" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pf_residual</text>
</a>
</g>
</g>
<!-- proc~pf_v_cycle&#45;&gt;proc~pf_residual -->
<g id="proc~~pf_block_run~~CallsGraph_edge13" class="edge"><title>proc~pf_v_cycle&#45;&gt;proc~pf_residual</title>
<path fill="none" stroke="#000000" d="M218.549,-454.641C263.957,-461.238 351.87,-474.591 426,-489.305 434.79,-491.05 444.17,-493.109 453.078,-495.159"/>
<polygon fill="#000000" stroke="#000000" points="452.345,-498.582 462.88,-497.453 453.94,-491.766 452.345,-498.582"/>
</g>
<!-- proc~interpolate_time_space -->
<g id="proc~~pf_block_run~~CallsGraph_node13" class="node"><title>proc~interpolate_time_space</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node13"><a xlink:href=".././proc/interpolate_time_space.html" xlink:title="interpolate_time_space">
<polygon fill="#d9534f" stroke="#d9534f" points="425,-442.305 301,-442.305 301,-418.305 425,-418.305 425,-442.305"/>
<text text-anchor="middle" x="363" y="-427.905" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpolate_time_space</text>
</a>
</g>
</g>
<!-- proc~pf_v_cycle&#45;&gt;proc~interpolate_time_space -->
<g id="proc~~pf_block_run~~CallsGraph_edge17" class="edge"><title>proc~pf_v_cycle&#45;&gt;proc~interpolate_time_space</title>
<path fill="none" stroke="#000000" d="M218.707,-446.776C238.687,-444.479 265.607,-441.385 290.72,-438.498"/>
<polygon fill="#000000" stroke="#000000" points="291.439,-441.939 300.974,-437.32 290.64,-434.985 291.439,-441.939"/>
</g>
<!-- proc~pf_send -->
<g id="proc~~pf_block_run~~CallsGraph_node14" class="node"><title>proc~pf_send</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node14"><a xlink:href=".././proc/pf_send.html" xlink:title="pf_send">
<polygon fill="#d9534f" stroke="#d9534f" points="390,-522.305 336,-522.305 336,-498.305 390,-498.305 390,-522.305"/>
<text text-anchor="middle" x="363" y="-507.905" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pf_send</text>
</a>
</g>
</g>
<!-- proc~pf_v_cycle&#45;&gt;proc~pf_send -->
<g id="proc~~pf_block_run~~CallsGraph_edge14" class="edge"><title>proc~pf_v_cycle&#45;&gt;proc~pf_send</title>
<path fill="none" stroke="#000000" d="M218.707,-460.894C248.727,-471.246 294.418,-487.001 326.101,-497.926"/>
<polygon fill="#000000" stroke="#000000" points="325.264,-501.34 335.859,-501.291 327.546,-494.722 325.264,-501.34"/>
</g>
<!-- proc~interpolate_q0 -->
<g id="proc~~pf_block_run~~CallsGraph_node15" class="node"><title>proc~interpolate_q0</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node15"><a xlink:href=".././proc/interpolate_q0.html" xlink:title="interpolate_q0">
<polygon fill="#d9534f" stroke="#d9534f" points="403.5,-282.305 322.5,-282.305 322.5,-258.305 403.5,-258.305 403.5,-282.305"/>
<text text-anchor="middle" x="363" y="-267.905" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">interpolate_q0</text>
</a>
</g>
</g>
<!-- proc~pf_v_cycle&#45;&gt;proc~interpolate_q0 -->
<g id="proc~~pf_block_run~~CallsGraph_edge15" class="edge"><title>proc~pf_v_cycle&#45;&gt;proc~interpolate_q0</title>
<path fill="none" stroke="#000000" d="M200.069,-438.197C215.25,-422.869 241.992,-395.537 264,-371.305 280.529,-353.105 283.073,-347.136 300,-329.305 313.091,-315.515 328.587,-300.769 340.812,-289.468"/>
<polygon fill="#000000" stroke="#000000" points="343.313,-291.924 348.315,-282.584 338.58,-286.766 343.313,-291.924"/>
</g>
<!-- proc~pf_recv -->
<g id="proc~~pf_block_run~~CallsGraph_node18" class="node"><title>proc~pf_recv</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node18"><a xlink:href=".././proc/pf_recv.html" xlink:title="pf_recv">
<polygon fill="#d9534f" stroke="#d9534f" points="390,-564.305 336,-564.305 336,-540.305 390,-540.305 390,-564.305"/>
<text text-anchor="middle" x="363" y="-549.905" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pf_recv</text>
</a>
</g>
</g>
<!-- proc~pf_v_cycle&#45;&gt;proc~pf_recv -->
<g id="proc~~pf_block_run~~CallsGraph_edge16" class="edge"><title>proc~pf_v_cycle&#45;&gt;proc~pf_recv</title>
<path fill="none" stroke="#000000" d="M201.942,-462.535C222.28,-479.855 261.828,-511.609 300,-531.305 308.218,-535.546 317.477,-539.212 326.283,-542.241"/>
<polygon fill="#000000" stroke="#000000" points="325.362,-545.622 335.955,-545.387 327.527,-538.965 325.362,-545.622"/>
</g>
<!-- proc~pf_predictor&#45;&gt;proc~end_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge18" class="edge"><title>proc~pf_predictor&#45;&gt;proc~end_timer</title>
<path fill="none" stroke="#000000" d="M222.337,-340.725C269,-329.184 354.787,-313.229 426,-329.305 485.123,-342.652 545.694,-381.513 578.24,-404.881"/>
<polygon fill="#000000" stroke="#000000" points="576.513,-407.953 586.652,-411.026 580.642,-402.301 576.513,-407.953"/>
</g>
<!-- proc~pf_predictor&#45;&gt;proc~call_hooks -->
<g id="proc~~pf_block_run~~CallsGraph_edge23" class="edge"><title>proc~pf_predictor&#45;&gt;proc~call_hooks</title>
<path fill="none" stroke="#000000" d="M198.11,-338.11C216.31,-316.935 256.741,-273.336 300,-249.305 326.384,-234.649 404.937,-214.447 453.766,-202.741"/>
<polygon fill="#000000" stroke="#000000" points="454.786,-206.096 463.705,-200.377 453.166,-199.286 454.786,-206.096"/>
</g>
<!-- proc~pf_predictor&#45;&gt;proc~start_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge25" class="edge"><title>proc~pf_predictor&#45;&gt;proc~start_timer</title>
<path fill="none" stroke="#000000" d="M193.811,-337.891C207.755,-309.568 246.007,-240.029 300,-206.305 387.269,-151.797 432.217,-137.375 529,-172.305 551.768,-180.522 572.468,-199.201 586.056,-213.739"/>
<polygon fill="#000000" stroke="#000000" points="583.556,-216.194 592.841,-221.298 588.765,-211.518 583.556,-216.194"/>
</g>
<!-- proc~pf_predictor&#45;&gt;proc~restrict_time_space_fas -->
<g id="proc~~pf_block_run~~CallsGraph_edge19" class="edge"><title>proc~pf_predictor&#45;&gt;proc~restrict_time_space_fas</title>
<path fill="none" stroke="#000000" d="M222.377,-350.305C241.616,-350.305 266.354,-350.305 289.65,-350.305"/>
<polygon fill="#000000" stroke="#000000" points="289.875,-353.805 299.875,-350.305 289.875,-346.805 289.875,-353.805"/>
</g>
<!-- proc~pf_predictor&#45;&gt;proc~pf_residual -->
<g id="proc~~pf_block_run~~CallsGraph_edge20" class="edge"><title>proc~pf_predictor&#45;&gt;proc~pf_residual</title>
<path fill="none" stroke="#000000" d="M222.216,-357.105C284.201,-369.668 410.152,-396.407 426,-409.305 454.677,-432.645 437.555,-456.564 462,-484.305 462.733,-485.137 463.506,-485.948 464.312,-486.739"/>
<polygon fill="#000000" stroke="#000000" points="462.274,-489.595 472.211,-493.27 466.734,-484.2 462.274,-489.595"/>
</g>
<!-- proc~pf_predictor&#45;&gt;proc~interpolate_time_space -->
<g id="proc~~pf_block_run~~CallsGraph_edge26" class="edge"><title>proc~pf_predictor&#45;&gt;proc~interpolate_time_space</title>
<path fill="none" stroke="#000000" d="M212.298,-362.473C234.869,-373.667 269.492,-390.565 300,-404.305 307.333,-407.608 315.211,-411.016 322.808,-414.234"/>
<polygon fill="#000000" stroke="#000000" points="321.644,-417.542 332.22,-418.186 324.355,-411.088 321.644,-417.542"/>
</g>
<!-- proc~pf_predictor&#45;&gt;proc~pf_send -->
<g id="proc~~pf_block_run~~CallsGraph_edge21" class="edge"><title>proc~pf_predictor&#45;&gt;proc~pf_send</title>
<path fill="none" stroke="#000000" d="M201.078,-362.331C231.057,-389.898 304.939,-457.835 341.219,-491.196"/>
<polygon fill="#000000" stroke="#000000" points="339.04,-493.947 348.77,-498.14 343.778,-488.794 339.04,-493.947"/>
</g>
<!-- proc~pf_predictor&#45;&gt;proc~interpolate_q0 -->
<g id="proc~~pf_block_run~~CallsGraph_edge22" class="edge"><title>proc~pf_predictor&#45;&gt;proc~interpolate_q0</title>
<path fill="none" stroke="#000000" d="M212.298,-338.138C234.869,-326.943 269.492,-310.045 300,-296.305 307.333,-293.002 315.211,-289.594 322.808,-286.376"/>
<polygon fill="#000000" stroke="#000000" points="324.355,-289.523 332.22,-282.424 321.644,-283.069 324.355,-289.523"/>
</g>
<!-- proc~pf_predictor&#45;&gt;proc~pf_recv -->
<g id="proc~~pf_block_run~~CallsGraph_edge24" class="edge"><title>proc~pf_predictor&#45;&gt;proc~pf_recv</title>
<path fill="none" stroke="#000000" d="M203.12,-362.502C220.057,-376.878 247.315,-402.254 264,-429.305 289.237,-470.222 265.791,-497.528 300,-531.305 307.082,-538.298 316.575,-542.964 326,-546.077"/>
<polygon fill="#000000" stroke="#000000" points="325.12,-549.465 335.693,-548.791 327.007,-542.724 325.12,-549.465"/>
</g>
<!-- end_timer -->
<g id="proc~~pf_block_run~~CallsGraph_node12" class="node"><title>end_timer</title>
<polygon fill="#777777" stroke="#777777" points="526,-635.305 465,-635.305 465,-611.305 526,-611.305 526,-635.305"/>
<text text-anchor="middle" x="495.5" y="-620.905" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">end_timer</text>
</g>
<!-- proc~pf_broadcast&#45;&gt;end_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge28" class="edge"><title>proc~pf_broadcast&#45;&gt;end_timer</title>
<path fill="none" stroke="#000000" d="M400.699,-632.649C417.43,-630.983 437.281,-629.005 454.404,-627.299"/>
<polygon fill="#000000" stroke="#000000" points="455.057,-630.752 464.66,-626.278 454.363,-623.786 455.057,-630.752"/>
</g>
<!-- start_timer -->
<g id="proc~~pf_block_run~~CallsGraph_node17" class="node"><title>start_timer</title>
<polygon fill="#777777" stroke="#777777" points="527.5,-677.305 463.5,-677.305 463.5,-653.305 527.5,-653.305 527.5,-677.305"/>
<text text-anchor="middle" x="495.5" y="-662.905" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">start_timer</text>
</g>
<!-- proc~pf_broadcast&#45;&gt;start_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge27" class="edge"><title>proc~pf_broadcast&#45;&gt;start_timer</title>
<path fill="none" stroke="#000000" d="M400.699,-644.46C417.056,-648.095 436.394,-652.393 453.25,-656.139"/>
<polygon fill="#000000" stroke="#000000" points="452.854,-659.636 463.375,-658.389 454.373,-652.803 452.854,-659.636"/>
</g>
<!-- proc~call_hooks&#45;&gt;proc~end_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge30" class="edge"><title>proc~call_hooks&#45;&gt;proc~end_timer</title>
<path fill="none" stroke="#000000" d="M502.925,-205.479C509.626,-218.284 520.34,-239.069 529,-257.305 553.4,-308.686 579.925,-370.12 593.453,-401.899"/>
<polygon fill="#000000" stroke="#000000" points="590.24,-403.287 597.369,-411.125 596.683,-400.552 590.24,-403.287"/>
</g>
<!-- proc~call_hooks&#45;&gt;proc~start_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge29" class="edge"><title>proc~call_hooks&#45;&gt;proc~start_timer</title>
<path fill="none" stroke="#000000" d="M527.16,-204.875C537.955,-208.949 550.265,-213.594 561.76,-217.932"/>
<polygon fill="#000000" stroke="#000000" points="560.582,-221.228 571.174,-221.484 563.053,-214.679 560.582,-221.228"/>
</g>
<!-- proc~restrict_time_space_fas&#45;&gt;proc~end_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge34" class="edge"><title>proc~restrict_time_space_fas&#45;&gt;proc~end_timer</title>
<path fill="none" stroke="#000000" d="M403.383,-362.36C447.572,-375.885 518.837,-397.698 563.052,-411.231"/>
<polygon fill="#000000" stroke="#000000" points="562.28,-414.655 572.866,-414.235 564.328,-407.961 562.28,-414.655"/>
</g>
<!-- proc~restrict_time_space_fas&#45;&gt;proc~call_hooks -->
<g id="proc~~pf_block_run~~CallsGraph_edge31" class="edge"><title>proc~restrict_time_space_fas&#45;&gt;proc~call_hooks</title>
<path fill="none" stroke="#000000" d="M378.326,-338.156C391.424,-326.714 410.986,-308.769 426,-291.305 447.593,-266.189 468.88,-234.31 481.854,-213.856"/>
<polygon fill="#000000" stroke="#000000" points="484.855,-215.659 487.201,-205.328 478.924,-211.941 484.855,-215.659"/>
</g>
<!-- proc~restrict_time_space_fas&#45;&gt;proc~start_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge33" class="edge"><title>proc~restrict_time_space_fas&#45;&gt;proc~start_timer</title>
<path fill="none" stroke="#000000" d="M388.625,-338.225C431.583,-317.151 520.262,-273.648 568.851,-249.812"/>
<polygon fill="#000000" stroke="#000000" points="570.572,-252.866 578.009,-245.32 567.489,-246.582 570.572,-252.866"/>
</g>
<!-- proc~restrict_sdc -->
<g id="proc~~pf_block_run~~CallsGraph_node20" class="node"><title>proc~restrict_sdc</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node20"><a xlink:href=".././proc/restrict_sdc.html" xlink:title="restrict_sdc">
<polygon fill="#d9534f" stroke="#d9534f" points="529,-475.305 462,-475.305 462,-451.305 529,-451.305 529,-475.305"/>
<text text-anchor="middle" x="495.5" y="-460.905" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">restrict_sdc</text>
</a>
</g>
</g>
<!-- proc~restrict_time_space_fas&#45;&gt;proc~restrict_sdc -->
<g id="proc~~pf_block_run~~CallsGraph_edge32" class="edge"><title>proc~restrict_time_space_fas&#45;&gt;proc~restrict_sdc</title>
<path fill="none" stroke="#000000" d="M403.584,-362.434C411.565,-366.059 419.491,-370.627 426,-376.305 449.722,-397 441.37,-413.526 462,-437.305 464.178,-439.816 466.623,-442.264 469.168,-444.59"/>
<polygon fill="#000000" stroke="#000000" points="467.039,-447.373 476.939,-451.148 471.554,-442.024 467.039,-447.373"/>
</g>
<!-- proc~pf_residual&#45;&gt;proc~end_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge36" class="edge"><title>proc~pf_residual&#45;&gt;proc~end_timer</title>
<path fill="none" stroke="#000000" d="M516.003,-493.239C520.348,-490.404 524.884,-487.326 529,-484.305 547.103,-471.017 566.621,-454.718 580.991,-442.312"/>
<polygon fill="#000000" stroke="#000000" points="583.562,-444.714 588.808,-435.509 578.967,-439.434 583.562,-444.714"/>
</g>
<!-- proc~pf_residual&#45;&gt;proc~start_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge35" class="edge"><title>proc~pf_residual&#45;&gt;proc~start_timer</title>
<path fill="none" stroke="#000000" d="M519.914,-493.155C523.319,-490.596 526.509,-487.643 529,-484.305 556.752,-447.108 587.048,-309.275 598.13,-255.24"/>
<polygon fill="#000000" stroke="#000000" points="601.584,-255.822 600.14,-245.325 594.723,-254.431 601.584,-255.822"/>
</g>
<!-- proc~interpolate_time_space&#45;&gt;proc~end_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge40" class="edge"><title>proc~interpolate_time_space&#45;&gt;proc~end_timer</title>
<path fill="none" stroke="#000000" d="M376.963,-442.366C389.603,-454.192 409.308,-472.797 426,-489.305 442.313,-505.439 440.863,-517.38 462,-526.305 489.432,-537.889 502.526,-539.937 529,-526.305 562.13,-509.246 583.626,-469.571 594.36,-444.742"/>
<polygon fill="#000000" stroke="#000000" points="597.626,-446.002 598.186,-435.422 591.15,-443.344 597.626,-446.002"/>
</g>
<!-- proc~interpolate_time_space&#45;&gt;proc~call_hooks -->
<g id="proc~~pf_block_run~~CallsGraph_edge37" class="edge"><title>proc~interpolate_time_space&#45;&gt;proc~call_hooks</title>
<path fill="none" stroke="#000000" d="M380.173,-418.304C393.952,-407.366 413.457,-390.088 426,-371.305 459.849,-320.616 480.437,-250.79 489.333,-215.557"/>
<polygon fill="#000000" stroke="#000000" points="492.841,-215.946 491.813,-205.401 486.041,-214.285 492.841,-215.946"/>
</g>
<!-- proc~interpolate_time_space&#45;&gt;proc~start_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge39" class="edge"><title>proc~interpolate_time_space&#45;&gt;proc~start_timer</title>
<path fill="none" stroke="#000000" d="M379.675,-418.182C409.239,-395.227 475.103,-343.649 529,-298.305 547.037,-283.13 567.05,-265.369 581.632,-252.252"/>
<polygon fill="#000000" stroke="#000000" points="584.049,-254.785 589.128,-245.488 579.359,-249.589 584.049,-254.785"/>
</g>
<!-- proc~pf_apply_mat -->
<g id="proc~~pf_block_run~~CallsGraph_node21" class="node"><title>proc~pf_apply_mat</title>
<g id="a_proc~~pf_block_run~~CallsGraph_node21"><a xlink:href=".././proc/pf_apply_mat.html" xlink:title="pf_apply_mat">
<polygon fill="#d9534f" stroke="#d9534f" points="642,-536.305 565,-536.305 565,-512.305 642,-512.305 642,-536.305"/>
<text text-anchor="middle" x="603.5" y="-521.905" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pf_apply_mat</text>
</a>
</g>
</g>
<!-- proc~interpolate_time_space&#45;&gt;proc~pf_apply_mat -->
<g id="proc~~pf_block_run~~CallsGraph_edge38" class="edge"><title>proc~interpolate_time_space&#45;&gt;proc~pf_apply_mat</title>
<path fill="none" stroke="#000000" d="M378.451,-442.349C391.635,-453.717 411.253,-471.614 426,-489.305 444.706,-511.746 436.3,-530.411 462,-544.305 495.006,-562.149 538.461,-551.686 568.255,-540.28"/>
<polygon fill="#000000" stroke="#000000" points="569.845,-543.412 577.8,-536.415 567.218,-536.924 569.845,-543.412"/>
</g>
<!-- proc~pf_send&#45;&gt;end_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge42" class="edge"><title>proc~pf_send&#45;&gt;end_timer</title>
<path fill="none" stroke="#000000" d="M390.293,-514.667C402.233,-517.715 415.909,-522.822 426,-531.305 451.577,-552.805 440.533,-571.7 462,-597.305 464.135,-599.852 466.553,-602.324 469.082,-604.664"/>
<polygon fill="#000000" stroke="#000000" points="466.943,-607.439 476.834,-611.237 471.47,-602.1 466.943,-607.439"/>
</g>
<!-- proc~pf_send&#45;&gt;start_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge41" class="edge"><title>proc~pf_send&#45;&gt;start_timer</title>
<path fill="none" stroke="#000000" d="M390.123,-513.62C402.461,-516.44 416.524,-521.656 426,-531.305 462.931,-568.913 429.985,-602.433 462,-644.305 462.474,-644.926 462.973,-645.533 463.492,-646.127"/>
<polygon fill="#000000" stroke="#000000" points="461.403,-648.959 471.154,-653.104 466.116,-643.783 461.403,-648.959"/>
</g>
<!-- proc~interpolate_q0&#45;&gt;proc~end_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge45" class="edge"><title>proc~interpolate_q0&#45;&gt;proc~end_timer</title>
<path fill="none" stroke="#000000" d="M403.822,-267.06C439.605,-266.158 492.055,-270.032 529,-295.305 566.297,-320.819 587.086,-371.919 596.413,-401.25"/>
<polygon fill="#000000" stroke="#000000" points="593.108,-402.414 599.34,-410.983 599.812,-400.399 593.108,-402.414"/>
</g>
<!-- proc~interpolate_q0&#45;&gt;proc~call_hooks -->
<g id="proc~~pf_block_run~~CallsGraph_edge43" class="edge"><title>proc~interpolate_q0&#45;&gt;proc~call_hooks</title>
<path fill="none" stroke="#000000" d="M396.89,-258.253C406.504,-254.271 416.876,-249.511 426,-244.305 435.102,-239.112 455.038,-224.103 471.068,-211.703"/>
<polygon fill="#000000" stroke="#000000" points="473.271,-214.424 479.017,-205.522 468.974,-208.898 473.271,-214.424"/>
</g>
<!-- proc~interpolate_q0&#45;&gt;proc~start_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge44" class="edge"><title>proc~interpolate_q0&#45;&gt;proc~start_timer</title>
<path fill="none" stroke="#000000" d="M403.651,-264.154C447.184,-257.4 516.762,-246.606 561.011,-239.742"/>
<polygon fill="#000000" stroke="#000000" points="561.794,-243.162 571.139,-238.17 560.72,-236.245 561.794,-243.162"/>
</g>
<!-- proc~pf_recv&#45;&gt;end_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge47" class="edge"><title>proc~pf_recv&#45;&gt;end_timer</title>
<path fill="none" stroke="#000000" d="M390.058,-559.2C401.422,-562.692 414.702,-567.444 426,-573.305 435.237,-578.097 455.16,-592.843 471.15,-605.088"/>
<polygon fill="#000000" stroke="#000000" points="469.019,-607.865 479.076,-611.198 473.293,-602.32 469.019,-607.865"/>
</g>
<!-- proc~pf_recv&#45;&gt;start_timer -->
<g id="proc~~pf_block_run~~CallsGraph_edge46" class="edge"><title>proc~pf_recv&#45;&gt;start_timer</title>
<path fill="none" stroke="#000000" d="M390.099,-556.454C402.138,-559.462 415.952,-564.597 426,-573.305 452.737,-596.476 438.322,-618.016 462,-644.305 462.742,-645.129 463.523,-645.933 464.335,-646.718"/>
<polygon fill="#000000" stroke="#000000" points="462.316,-649.588 472.27,-653.217 466.752,-644.173 462.316,-649.588"/>
</g>
<!-- proc~restrict_sdc&#45;&gt;proc~pf_apply_mat -->
<g id="proc~~pf_block_run~~CallsGraph_edge48" class="edge"><title>proc~restrict_sdc&#45;&gt;proc~pf_apply_mat</title>
<path fill="none" stroke="#000000" d="M517.442,-475.357C533.267,-484.464 555.199,-497.085 572.829,-507.231"/>
<polygon fill="#000000" stroke="#000000" points="571.188,-510.324 581.601,-512.279 574.68,-504.257 571.188,-510.324"/>
</g>
</g>
</svg>
</div><script>var panprocpf_block_runCallsGraph = svgPanZoom('#procpf_block_runCallsGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="560pt" height="32pt"
 viewBox="0.00 0.00 559.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555.5,-28 555.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.5,-24 154.5,-24 154.5,-0 209.5,-0 209.5,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.5,-24 454.5,-24 454.5,-0 551.5,-0 551.5,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
     
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: proc~~pf_block_run~~CalledByGraph Pages: 1 -->
<svg id="procpf_block_runCalledByGraph" width="196pt" height="32pt"
 viewBox="0.00 0.00 196.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~pf_block_run~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>proc~~pf_block_run~~CalledByGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 192,-28 192,4 -4,4"/>
<!-- proc~pf_block_run -->
<g id="proc~~pf_block_run~~CalledByGraph_node1" class="node"><title>proc~pf_block_run</title>
<polygon fill="none" stroke="black" points="188,-24 114,-24 114,-0 188,-0 188,-24"/>
<text text-anchor="middle" x="151" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">pf_block_run</text>
</g>
<!-- proc~pf_pfasst_run -->
<g id="proc~~pf_block_run~~CalledByGraph_node2" class="node"><title>proc~pf_pfasst_run</title>
<g id="a_proc~~pf_block_run~~CalledByGraph_node2"><a xlink:href=".././proc/pf_pfasst_run.html" xlink:title="pf_pfasst_run">
<polygon fill="#d9534f" stroke="#d9534f" points="78,-24 0,-24 0,-0 78,-0 78,-24"/>
<text text-anchor="middle" x="39" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pf_pfasst_run</text>
</a>
</g>
</g>
<!-- proc~pf_pfasst_run&#45;&gt;proc~pf_block_run -->
<g id="proc~~pf_block_run~~CalledByGraph_edge1" class="edge"><title>proc~pf_pfasst_run&#45;&gt;proc~pf_block_run</title>
<path fill="none" stroke="#000000" d="M78.164,-12C86.3694,-12 95.1281,-12 103.607,-12"/>
<polygon fill="#000000" stroke="#000000" points="103.755,-15.5001 113.754,-12 103.754,-8.5001 103.755,-15.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="560pt" height="32pt"
 viewBox="0.00 0.00 559.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555.5,-28 555.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.5,-24 154.5,-24 154.5,-0 209.5,-0 209.5,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.5,-24 454.5,-24 454.5,-0 551.5,-0 551.5,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/pf_block_run.html#src">pf_block_run</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span>  <span class="k">subroutine </span><span class="n">pf_block_run</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">q0</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">nsteps</span><span class="p">,</span> <span class="n">qend</span><span class="p">,</span><span class="n">flags</span><span class="p">)</span>
    <span class="k">type</span><span class="p">(</span><span class="n">pf_pfasst_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">),</span> <span class="k">target</span>   <span class="kd">::</span> <span class="n">pf</span>
    <span class="k">class</span><span class="p">(</span><span class="n">pf_encap_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span>   <span class="p">)</span>           <span class="kd">::</span> <span class="n">q0</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">pfdp</span><span class="p">),</span>        <span class="k">intent</span><span class="p">(</span><span class="n">in</span>   <span class="p">)</span>           <span class="kd">::</span> <span class="n">dt</span>
    <span class="kt">integer</span><span class="p">,</span>           <span class="k">intent</span><span class="p">(</span><span class="n">in</span>   <span class="p">)</span>           <span class="kd">::</span> <span class="n">nsteps</span>
    <span class="k">class</span><span class="p">(</span><span class="n">pf_encap_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">qend</span>
    <span class="kt">integer</span><span class="p">,</span>           <span class="k">intent</span><span class="p">(</span><span class="n">in</span>   <span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">flags</span><span class="p">(:)</span>
    
    <span class="k">class</span><span class="p">(</span><span class="n">pf_level_t</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">lev_p</span>  <span class="c">!!  pointer to the one level we are operating on</span>
    <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span>
    <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">nblocks</span> <span class="c">!!  The number of blocks of steps to do</span>
    <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">nproc</span>   <span class="c">!!  The number of processors being used</span>
    <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">level_index_c</span> <span class="c">!!  Coarsest leve in V-cycle</span>


    <span class="k">call </span><span class="n">start_timer</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">TTOTAL</span><span class="p">)</span>

    <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">dt</span>      <span class="o">=</span> <span class="n">dt</span>
    <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">proc</span>    <span class="o">=</span> <span class="n">pf</span><span class="p">%</span><span class="n">rank</span><span class="o">+</span><span class="mi">1</span>
    <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">step</span>    <span class="o">=</span> <span class="n">pf</span><span class="p">%</span><span class="n">rank</span>
    <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">t0</span>      <span class="o">=</span> <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">step</span> <span class="o">*</span> <span class="n">dt</span>


    <span class="c">!  pointer to finest  level to start</span>
    <span class="n">lev_p</span> <span class="o">=&gt;</span> <span class="n">pf</span><span class="p">%</span><span class="n">levels</span><span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">nlevels</span><span class="p">)</span>

    <span class="c">!  Stick the initial condition into q0 (will happen on all processors)</span>
    <span class="k">call </span><span class="n">lev_p</span><span class="p">%</span><span class="n">q0</span><span class="p">%</span><span class="n">copy</span><span class="p">(</span><span class="n">q0</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>    

    
    <span class="n">nproc</span> <span class="o">=</span> <span class="n">pf</span><span class="p">%</span><span class="n">comm</span><span class="p">%</span><span class="n">nproc</span>
    <span class="n">nblocks</span> <span class="o">=</span> <span class="n">nsteps</span><span class="o">/</span><span class="n">nproc</span>

    <span class="c">!  Decide what the coarsest level in the V-cycle is</span>
    <span class="n">level_index_c</span><span class="o">=</span><span class="mi">1</span>
    <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">pf</span><span class="p">%</span><span class="n">Vcycle</span><span class="p">)</span>     <span class="n">level_index_c</span><span class="o">=</span><span class="n">pf</span><span class="p">%</span><span class="n">nlevels</span>

    <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nblocks</span>   <span class="c">!  Loop over blocks of time steps</span>
       <span class="c">! print *,&#39;Starting  step=&#39;,pf%state%step,&#39;  block k=&#39;,k      </span>
       <span class="c">! Each block will consist of</span>
       <span class="c">!  1.  predictor</span>
       <span class="c">!  2.  Vcycle until max iterations, or tolerances met</span>
       <span class="c">!  3.  Move solution to next block</span>

       <span class="c">!  Reset some flags</span>
       <span class="c">!&gt;  When starting a new block, broadcast new initial conditions to all procs</span>
       <span class="c">!&gt;  For initial block, this is done when initial conditions are set</span>

       <span class="c">!&gt; Reset some flags</span>
       <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">iter</span>    <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
       <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">itcnt</span>   <span class="o">=</span> <span class="mi">0</span>
       <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">mysteps</span> <span class="o">=</span> <span class="mi">0</span>
       <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">status</span>  <span class="o">=</span> <span class="n">PF_STATUS_PREDICTOR</span>
       <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">pstatus</span> <span class="o">=</span> <span class="n">PF_STATUS_PREDICTOR</span>
       <span class="n">pf</span><span class="p">%</span><span class="n">comm</span><span class="p">%</span><span class="n">statreq</span>  <span class="o">=</span> <span class="o">-</span><span class="mi">66</span>

       <span class="k">if</span> <span class="p">(</span><span class="n">k</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">          if</span> <span class="p">(</span><span class="n">nproc</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span>  <span class="k">then</span>
<span class="k">             call </span><span class="n">lev_p</span><span class="p">%</span><span class="n">qend</span><span class="p">%</span><span class="nb">pack</span><span class="p">(</span><span class="n">lev_p</span><span class="p">%</span><span class="n">send</span><span class="p">)</span>    <span class="c">!!  Pack away your last solution</span>
             <span class="k">call </span><span class="n">pf_broadcast</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">lev_p</span><span class="p">%</span><span class="n">send</span><span class="p">,</span> <span class="n">lev_p</span><span class="p">%</span><span class="n">mpibuflen</span><span class="p">,</span> <span class="n">pf</span><span class="p">%</span><span class="n">comm</span><span class="p">%</span><span class="n">nproc</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
             <span class="k">call </span><span class="n">lev_p</span><span class="p">%</span><span class="n">q0</span><span class="p">%</span><span class="nb">unpack</span><span class="p">(</span><span class="n">lev_p</span><span class="p">%</span><span class="n">send</span><span class="p">)</span>    <span class="c">!!  Everyone resets their q0</span>
          <span class="k">else</span>
<span class="k">             call </span><span class="n">lev_p</span><span class="p">%</span><span class="n">q0</span><span class="p">%</span><span class="n">copy</span><span class="p">(</span><span class="n">lev_p</span><span class="p">%</span><span class="n">qend</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>    <span class="c">!!  Just stick qend in q0</span>
          <span class="k">end if</span>

          <span class="c">!&gt;  Update the step and t0 variables for new block</span>
          <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">step</span> <span class="o">=</span> <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">step</span> <span class="o">+</span> <span class="n">pf</span><span class="p">%</span><span class="n">comm</span><span class="p">%</span><span class="n">nproc</span>
          <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">t0</span>   <span class="o">=</span> <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">step</span> <span class="o">*</span> <span class="n">dt</span>
       <span class="k">end if</span>    

       <span class="c">!&gt; Call the predictor to get an initial guess on all levels and all processors</span>
       <span class="k">call </span><span class="n">pf_predictor</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">t0</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">flags</span><span class="p">)</span>

       <span class="c">!&gt;  Start the loops over SDC sweeps</span>
       <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">iter</span> <span class="o">=</span> <span class="mi">0</span>
       <span class="k">call </span><span class="n">call_hooks</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">PF_POST_ITERATION</span><span class="p">)</span>
       
       <span class="k">call </span><span class="n">start_timer</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">TITERATION</span><span class="p">)</span>
       <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">pf</span><span class="p">%</span><span class="n">niters</span>

          <span class="k">call </span><span class="n">call_hooks</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">PF_PRE_ITERATION</span><span class="p">)</span>

          <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">iter</span> <span class="o">=</span> <span class="n">j</span>

          <span class="c">!  Do a v_cycle</span>
          <span class="k">call </span><span class="n">pf_v_cycle</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">t0</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span><span class="n">level_index_c</span><span class="p">,</span><span class="n">pf</span><span class="p">%</span><span class="n">nlevels</span><span class="p">)</span>

          <span class="c">!  Check for convergence</span>
          <span class="k">call </span><span class="n">pf_check_convergence_block</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">send_tag</span><span class="o">=</span><span class="mi">1111</span><span class="o">*</span><span class="n">k</span><span class="o">+</span><span class="n">j</span><span class="p">)</span>
          <span class="k">if</span> <span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">save_results</span><span class="p">)</span> <span class="n">pf</span><span class="p">%</span><span class="n">results</span><span class="p">%</span><span class="n">residuals</span><span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">iter</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">lev_p</span><span class="p">%</span><span class="nb">index</span><span class="p">)</span> <span class="o">=</span> <span class="n">lev_p</span><span class="p">%</span><span class="n">residual</span>

<span class="c">!          print *,pf%rank, &#39; post res&#39;</span>
          <span class="k">call </span><span class="n">call_hooks</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">PF_POST_ITERATION</span><span class="p">)</span>

          <span class="c">!  If we are converged, exit block</span>
          <span class="k">if</span> <span class="p">(</span><span class="n">pf</span><span class="p">%</span><span class="n">state</span><span class="p">%</span><span class="n">status</span> <span class="o">==</span> <span class="n">PF_STATUS_CONVERGED</span><span class="p">)</span>  <span class="k">exit</span>
<span class="k">       end do</span>  <span class="c">!  Loop over the iteration in this bloc</span>
       <span class="k">call </span><span class="n">call_hooks</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">PF_POST_CONVERGENCE</span><span class="p">)</span>
       <span class="k">call </span><span class="n">end_timer</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">TITERATION</span><span class="p">)</span>
       <span class="k">call </span><span class="n">call_hooks</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">PF_POST_STEP</span><span class="p">)</span>
    <span class="k">end do</span> <span class="c">!  Loop over the blocks</span>

    <span class="k">call </span><span class="n">end_timer</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">TTOTAL</span><span class="p">)</span>

    <span class="c">!  Grab the last solution for return (if wanted)</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">qend</span><span class="p">))</span> <span class="k">then</span>
<span class="k">       call </span><span class="n">qend</span><span class="p">%</span><span class="n">copy</span><span class="p">(</span><span class="n">lev_p</span><span class="p">%</span><span class="n">qend</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">end if</span>
<span class="k">  end subroutine </span><span class="n">pf_block_run</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2019 <a rel="license" href="http://www.freebsd.org/copyright/freebsd-doc-license.html">FreeBSD Documentation License</a>
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> libpfasst was developed by Matthew Emmett. Michael Minion, Sebastian Goetschel, Brandon Krull, Francois Hamon</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>